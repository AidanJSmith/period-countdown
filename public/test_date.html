<!DOCTYPE html>
<html>
<head>
	<title>test</title>
</head>
<body>

</body>
<script type="text/javascript">
	var ajax = function(params) {
		return new Promise((resolve, reject) => {
			let xhr = new XMLHttpRequest();
			if (!params.type) params.type = "GET";
			xhr.open(params.type, params.url, true);
			if (params.type !== "GET") xhr.setRequestHeader("Content-Type", "application/json");
			xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");
			xhr.onerror = () => {xhr.loadTime  = Date.now() - startTime; reject(xhr)}
			xhr.onload = () => {xhr.loadTime  = Date.now() - startTime; resolve(xhr)}
			var startTime = Date.now();
			(params.data !== null || params.data !== undefined) ? xhr.send(params.data) : xhr.send();
		});
	}

	ajax({
		url: '/api/time'
	}).then((data) => {
		var timeNow = JSON.parse(data.responseText).data.ms + data.loadTime;
		var secondsOffset = timeNow - Date.now();
		
		var d = new Date(timeNow);

	});
</script>
</html>